# Backend API con Arquitectura Hexagonal

Este proyecto implementa una‚îú‚îÄ‚îÄ shared/ # üîÑ UTILIDADES COMPARTIDAS
‚îÇ ‚îú‚îÄ‚îÄ Config.ts # Configuraci√≥n de la aplicaci√≥n
‚îÇ ‚îî‚îÄ‚îÄ swagger.ts # Configuraci√≥n de Swagger UI
‚îÇ
‚îú‚îÄ‚îÄ App.ts # üöÄ Configuraci√≥n principal de Express
‚îî‚îÄ‚îÄ main.ts # üéØ Punto de entrada de la aplicaci√≥n

```

## üöÄ Endpoints de la API

| M√©todo | Endpoint         | Descripci√≥n              |
|--------|------------------|--------------------------|
| GET    | `/api/tasks`     | Obtener todas las tareas |
| POST   | `/api/tasks`     | Crear una nueva tarea    |
| PUT    | `/api/tasks/:id` | Actualizar una tarea     |
| DELETE | `/api/tasks/:id` | Eliminar una tarea       |
| GET    | `/health`        | Health check de la API   |
| GET    | `/api-docs`      | Documentaci√≥n Swagger UI |
| GET    | `/api-docs.json` | Especificaci√≥n OpenAPI   |ul para gesti√≥n de tareas siguiendo los principios de **Arquitectura Hexagonal** (tambi√©n conocida como Ports and Adapters) usando Node.js, Express.js, TypeScript y PrismaJS.

## üèóÔ∏è Arquitectura Hexagonal

La arquitectura hexagonal separa la l√≥gica de negocio de los detalles de implementaci√≥n, proporcionando:

- **Testabilidad**: F√°cil testing unitario al aislar la l√≥gica de negocio
- **Mantenibilidad**: Cambios en infraestructura no afectan el dominio
- **Flexibilidad**: F√°cil intercambio de adaptadores (base de datos, frameworks, etc.)
- **Inversi√≥n de dependencias**: El dominio no depende de la infraestructura

### Capas de la Arquitectura

```

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üåê INTERFACES ‚îÇ
‚îÇ (Controllers, Routes, Middlewares - HTTP Adapters) ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üìã APPLICATION ‚îÇ
‚îÇ (Use Cases, DTOs - Application Services) ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üèõÔ∏è DOMAIN ‚îÇ
‚îÇ (Entities, Value Objects, Repository Interfaces) ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üîß INFRASTRUCTURE ‚îÇ
‚îÇ (Database, External APIs - Implementation Details) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

```

## üìÅ Estructura del Proyecto

```

src/
‚îú‚îÄ‚îÄ domain/ # üèõÔ∏è CAPA DE DOMINIO
‚îÇ ‚îú‚îÄ‚îÄ shared/ # Elementos compartidos del dominio
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ BaseEntity.ts # Entidad base
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ DomainErrors.ts # Errores del dominio
‚îÇ ‚îî‚îÄ‚îÄ task/ # Contexto de tareas
‚îÇ ‚îú‚îÄ‚îÄ entities/ # Entidades del dominio
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ Task.ts # Entidad Task
‚îÇ ‚îî‚îÄ‚îÄ repositories/ # Interfaces de repositorio
‚îÇ ‚îî‚îÄ‚îÄ TaskRepository.ts
‚îÇ
‚îú‚îÄ‚îÄ application/ # üìã CAPA DE APLICACI√ìN
‚îÇ ‚îî‚îÄ‚îÄ task/
‚îÇ ‚îú‚îÄ‚îÄ dtos/ # Data Transfer Objects
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ TaskDtos.ts
‚îÇ ‚îî‚îÄ‚îÄ usecases/ # Casos de uso
‚îÇ ‚îú‚îÄ‚îÄ CreateTaskUseCase.ts
‚îÇ ‚îú‚îÄ‚îÄ GetAllTasksUseCase.ts
‚îÇ ‚îú‚îÄ‚îÄ UpdateTaskUseCase.ts
‚îÇ ‚îî‚îÄ‚îÄ DeleteTaskUseCase.ts
‚îÇ
‚îú‚îÄ‚îÄ infrastructure/ # üîß CAPA DE INFRAESTRUCTURA
‚îÇ ‚îú‚îÄ‚îÄ database/ # Configuraci√≥n de base de datos
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ DatabaseConnection.ts
‚îÇ ‚îî‚îÄ‚îÄ repositories/ # Implementaciones de repositorio
‚îÇ ‚îî‚îÄ‚îÄ PrismaTaskRepository.ts
‚îÇ
‚îú‚îÄ‚îÄ interfaces/ # üåê CAPA DE INTERFACES
‚îÇ ‚îî‚îÄ‚îÄ http/ # Adaptadores HTTP
‚îÇ ‚îú‚îÄ‚îÄ controllers/ # Controladores REST
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ TaskController.ts
‚îÇ ‚îú‚îÄ‚îÄ routes/ # Definici√≥n de rutas
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ taskRoutes.ts
‚îÇ ‚îî‚îÄ‚îÄ middlewares/ # Middlewares de Express
‚îÇ ‚îî‚îÄ‚îÄ errorHandler.ts
‚îÇ
‚îú‚îÄ‚îÄ shared/ # üîÑ UTILIDADES COMPARTIDAS
‚îÇ ‚îú‚îÄ‚îÄ Config.ts # Configuraci√≥n de la aplicaci√≥n
‚îÇ ‚îî‚îÄ‚îÄ swagger.ts # Configuraci√≥n de Swagger UI
‚îÇ
‚îú‚îÄ‚îÄ App.ts # üöÄ Configuraci√≥n principal de Express
‚îî‚îÄ‚îÄ main.ts # üéØ Punto de entrada de la aplicaci√≥n

````

## üöÄ Endpoints de la API

| M√©todo | Endpoint         | Descripci√≥n              |
|--------|------------------|--------------------------|
| GET    | `/api/tasks`     | Obtener todas las tareas |
| POST   | `/api/tasks`     | Crear una nueva tarea    |
| PUT    | `/api/tasks/:id` | Actualizar una tarea     |
| DELETE | `/api/tasks/:id` | Eliminar una tarea       |
| GET    | `/health`        | Health check de la API   |
| GET    | `/api-docs`      | Documentaci√≥n Swagger UI |
| GET    | `/api-docs.json` | Especificaci√≥n OpenAPI   |

## üìö Documentaci√≥n Interactiva con Swagger UI

La API incluye documentaci√≥n interactiva completa usando **Swagger UI** y **OpenAPI 3.0**:

- **üåê Swagger UI**: `http://localhost:3000/api-docs`
- **üìÑ OpenAPI JSON**: `http://localhost:3000/api-docs.json`

### Caracter√≠sticas de la Documentaci√≥n:

‚úÖ **Interfaz Interactiva**: Prueba todos los endpoints directamente desde el navegador
‚úÖ **Esquemas Detallados**: Definiciones completas de Request/Response
‚úÖ **Ejemplos en Vivo**: Datos de ejemplo para cada endpoint
‚úÖ **Validaciones**: Documentaci√≥n de todas las reglas de validaci√≥n
‚úÖ **C√≥digos de Estado**: Explicaci√≥n de todos los c√≥digos HTTP posibles
‚úÖ **Arquitectura**: Documentaci√≥n de la arquitectura hexagonal implementada

### Ejemplos de Uso

#### Crear una tarea

```bash
curl -X POST http://localhost:3000/api/tasks \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Completar proyecto",
    "description": "Finalizar la implementaci√≥n del backend"
  }'
````

#### Obtener todas las tareas

```bash
curl http://localhost:3000/api/tasks
```

#### Actualizar una tarea

```bash
curl -X PUT http://localhost:3000/api/tasks/:id \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Tarea actualizada",
    "description": "Nueva descripci√≥n",
    "completed": true
  }'
```

#### Eliminar una tarea

```bash
curl -X DELETE http://localhost:3000/api/tasks/:id
```

#### Acceder a la Documentaci√≥n Swagger

```bash
# Abrir Swagger UI en el navegador
open http://localhost:3000/api-docs

# O obtener la especificaci√≥n OpenAPI JSON
curl http://localhost:3000/api-docs.json
```

## ‚öôÔ∏è Instalaci√≥n y Configuraci√≥n

### Prerrequisitos

- Node.js >= 18
- npm o yarn

### Pasos de instalaci√≥n

1. **Instalar dependencias**

```bash
npm install
```

2. **Configurar la base de datos**

```bash
# Generar el cliente de Prisma
npm run prisma:generate

# Ejecutar migraciones
npm run prisma:migrate
```

3. **Configurar variables de entorno**

```bash
# El archivo .env ya est√° configurado con valores por defecto
NODE_ENV=development
PORT=3000
DATABASE_URL="postgresql://johndoe:randompassword@localhost:5432/mydb?schema=publi"
```

4. **Ejecutar en desarrollo**

```bash
npm run dev
```

5. **Acceder a la aplicaci√≥n**

```bash
# API Principal
http://localhost:3000

# Documentaci√≥n Swagger UI
http://localhost:3000/api-docs

# Health Check
http://localhost:3000/health

# Endpoints de tareas
http://localhost:3000/api/tasks
```

6. **Compilar para producci√≥n**

```bash
npm run build
npm start
```

## üèõÔ∏è Detalles de la Arquitectura

### Capa de Dominio (Domain)

- **Prop√≥sito**: Contiene la l√≥gica de negocio pura
- **Responsabilidades**:
  - Definir entidades y reglas de negocio
  - Establecer contratos (interfaces) para repositorios
  - Validaciones de dominio
- **Independencia**: No depende de ninguna otra capa

### Capa de Aplicaci√≥n (Application)

- **Prop√≥sito**: Orquesta los casos de uso de la aplicaci√≥n
- **Responsabilidades**:
  - Implementar casos de uso espec√≠ficos
  - Coordinar entre dominio e infraestructura
  - Transformar datos con DTOs
- **Dependencias**: Solo del dominio

### Capa de Infraestructura (Infrastructure)

- **Prop√≥sito**: Implementa los detalles t√©cnicos
- **Responsabilidades**:
  - Implementar repositorios concretos
  - Configurar conexiones a base de datos
  - Integrar servicios externos
- **Dependencias**: Del dominio y aplicaci√≥n

### Capa de Interfaces (Interfaces)

- **Prop√≥sito**: Expone la aplicaci√≥n al mundo exterior
- **Responsabilidades**:
  - Manejar requests/responses HTTP
  - Rutear peticiones
  - Manejar errores
- **Dependencias**: De todas las capas internas

## üîß Caracter√≠sticas T√©cnicas

### Validaciones

- Validaci√≥n de DTOs con m√©todos personalizados
- Validaci√≥n de entidades en el dominio
- Manejo robusto de errores con middlewares

### Manejo de Errores

- Errores espec√≠ficos del dominio (`DomainError`, `EntityNotFoundError`, `ValidationError`)
- Middleware centralizado de manejo de errores
- Respuestas HTTP sem√°nticas

### Base de Datos

- ORM: PrismaJS con SQLite (f√°cil cambio a PostgreSQL/MySQL)
- Migraciones autom√°ticas
- Conexi√≥n singleton con pooling

### TypeScript

- Tipado estricto habilitado
- Paths aliases para imports limpios
- Decorators para futura extensibilidad

## üóÑÔ∏è Decisi√≥n de Base de Datos: PostgreSQL

### ¬øPor qu√© PostgreSQL para esta prueba t√©cnica?

He elegido **PostgreSQL** como base de datos para esta implementaci√≥n por las siguientes razones t√©cnicas:

#### ‚úÖ **Ventajas para Entornos Profesionales**

- **Robustez Empresarial**: PostgreSQL es ampliamente utilizado en entornos de producci√≥n
- **Compatibilidad**: Refleja mejor las decisiones tecnol√≥gicas de aplicaciones reales
- **Escalabilidad**: Manejo superior de concurrencia y grandes vol√∫menes de datos

#### ‚úÖ **Caracter√≠sticas T√©cnicas Relevantes**

- **ACID Compliance**: Garant√≠as de transacciones robustas
- **Extensibilidad**: Soporte para JSON, arrays y tipos de datos avanzados
- **Performance**: Optimizaciones autom√°ticas y √≠ndices eficientes
- **Integridad Referencial**: Constraints y validaciones a nivel de base de datos

#### ‚úÖ **Beneficios para el Desarrollo**

- **PrismaJS Integration**: Excelente soporte y generaci√≥n de tipos TypeScript
- **Docker-Friendly**: F√°cil containerizaci√≥n para desarrollo y despliegue
- **Tooling**: Abundantes herramientas de administraci√≥n y monitoreo

#### üîÑ **Flexibilidad de la Arquitectura Hexagonal**

Gracias a la **Arquitectura Hexagonal** implementada, cambiar de PostgreSQL a otra base de datos (MySQL, MongoDB, etc.) requiere √∫nicamente:

1. Modificar la implementaci√≥n del repositorio en la capa de infraestructura
2. Actualizar la configuraci√≥n de PrismaJS
3. **La l√≥gica de negocio permanece intacta**

```typescript
// Solo cambiar√≠amos esta implementaci√≥n:
// src/infrastructure/repositories/PrismaTaskRepository.ts
// El dominio y aplicaci√≥n no se ven afectados
```

### Configuraci√≥n de PostgreSQL

```bash
# Variables de entorno para PostgreSQL
DATABASE_URL="postgresql://username:password@localhost:5432/zurich_tasks_db"

# Docker Compose para desarrollo local
docker-compose up -d postgres
```

Esta decisi√≥n demuestra el valor de la **Arquitectura Hexagonal**: podemos tomar decisiones de infraestructura sin comprometer la l√≥gica de negocio, manteniendo la aplicaci√≥n testeable y flexible.

## üìö Principios Aplicados

### SOLID

- **Single Responsibility**: Cada clase tiene una √∫nica responsabilidad
- **Open/Closed**: Extensible sin modificar c√≥digo existente
- **Liskov Substitution**: Interfaces bien definidas
- **Interface Segregation**: Interfaces espec√≠ficas y cohesivas
- **Dependency Inversion**: Dependencias hacia abstracciones

### Clean Architecture

- Separaci√≥n clara de responsabilidades
- Flujo de dependencias hacia el dominio
- Testabilidad mediante inversi√≥n de dependencias

### Domain-Driven Design (DDD)

- Entidades con l√≥gica de negocio encapsulada
- Value Objects para conceptos del dominio
- Repositorios como abstracci√≥n de persistencia

## üß™ Testing (Recomendaciones)

La arquitectura facilita el testing en m√∫ltiples niveles:

```bash
# Testing unitario del dominio
src/domain/__tests__/

# Testing de casos de uso
src/application/__tests__/

# Testing de integraci√≥n
src/infrastructure/__tests__/

# Testing end-to-end
src/interfaces/__tests__/
```

## üöÄ Despliegue

### Docker (Opcional)

```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY dist ./dist
COPY prisma ./prisma
RUN npx prisma generate
EXPOSE 3000
CMD ["npm", "start"]
```

### Variables de Entorno para Producci√≥n

```bash
NODE_ENV=production
PORT=3000
DATABASE_URL="postgresql://user:password@localhost:5432/tasks_db"
```

## üë• Contribuci√≥n

1. Fork del proyecto
2. Crear feature branch (`git checkout -b feature/nueva-funcionalidad`)
3. Commit de cambios (`git commit -am 'Agregar nueva funcionalidad'`)
4. Push a la branch (`git push origin feature/nueva-funcionalidad`)
5. Crear Pull Request

## üìÑ Licencia

MIT License - ver el archivo [LICENSE](LICENSE) para detalles.

---

## üéØ Flujo de Comunicaci√≥n Entre Capas

```
üì± HTTP Request
    ‚Üì
üåê Controller (Interfaces)
    ‚Üì
üìã Use Case (Application)
    ‚Üì
üèõÔ∏è Domain Entity + Repository Interface (Domain)
    ‚Üì
üîß Repository Implementation (Infrastructure)
    ‚Üì
üíæ Database (PrismaJS + SQLite)
    ‚Üì
üîß Repository Implementation (Infrastructure)
    ‚Üì
üèõÔ∏è Domain Entity (Domain)
    ‚Üì
üìã DTO Response (Application)
    ‚Üì
üåê HTTP Response (Interfaces)
    ‚Üì
üì± Client
```

Este dise√±o garantiza que los cambios en la infraestructura (base de datos, framework web) no afecten la l√≥gica de negocio, y que la aplicaci√≥n sea f√°cilmente testeable y mantenible.
